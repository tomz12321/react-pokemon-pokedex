# 專案計劃：寶可夢代購服務與 TapPay 金流整合

## 1. 概述

我們計劃在寶可夢圖鑑應用程式中引入「代購服務」功能。此功能允許使用者在批量訂購（10 隻以上）時，請求從特定寶可夢中心購買寶可夢。付款將透過 TapPay（信用卡）安全處理。

## 2. 服務範圍

### 2.1 支援地點

- 寶可夢中心 台北
- 寶可夢中心 沖繩
- 寶可夢中心 福岡
- 寶可夢中心 東京日本橋

### 2.2 可購買寶可夢（限定選擇）

- 皮卡丘（Pikachu）
- 快龍（Dragonite）
- 路卡利歐（Lucario）
- 烈咬陸鯊（Garchomp）

### 2.3 業務邏輯

- **數量門檻**：如果使用者訂購**10 隻或更多**特定寶可夢，將顯示特別訊息：
  > "訓練家 tomz12321 將會替你前往指定的寶可夢中心收服牠們！"
  > (只要代購數量達到十隻，訓練家 tomz12321 就會代替你前往該寶可夢中心收服，你指定的寶可夢喔！)

## 3. 技術架構選項

### 選項 A：專用頁面（推薦）

- **路由**：`/purchasing-agent`
- **導航**：在主導航列或標題中添加「代購 / Buy」連結。
- **優點**：
  - 擁有獨立的 URL 可供分享。
  - 與圖鑑瀏覽體驗清楚分離。
  - 擁有完整頁面空間呈現付款表單。

### 選項 B：模態框整合

- **觸發方式**：在卡片列表上添加「購買」按鈕。
- **優點**：符合上下文。
- **缺點**：信用卡付款表單在模態框中可能顯得擁擠；「代購服務」的邏輯意味著這是一個服務請求，而非簡單的加入購物車操作。

**決定**：我們將採用**選項 A**（如需求所述：「有導頁連結可以連到這個頁面」）。

## 4. 實作計劃

### 階段 1：準備工作

1.  **SDK 設定**：將 TapPay SDK 腳本添加到 `public/index.html`（或 Vite 專案根目錄的 `index.html`）。
2.  **環境變數**：配置 TapPay App ID 和 Key（沙箱模式）。

### 階段 2：React 元件

1.  **PurchasingAgentPage**：
    - **選擇表單**：寶可夢、地點下拉選單，以及數量輸入。
    - **訊息顯示**：根據數量 >= 10 條件渲染。
    - **付款表單（TapPay）**：
      - 信用卡號、到期日、安全碼（託管欄位）。
      - 「立即付款」按鈕。

2.  **路由配置**：
    - 在 `App.jsx` 中添加 `<Route path="/purchasing-agent" element={<PurchasingAgentPage />} />`。
    - 在 `App.jsx` 導航列中添加連結。

### 階段 3：TapPay 整合（參考：`tappay-card` 技能）

- 使用 `TPDirect.setupSDK` 進行初始化。
- 使用 `TPDirect.card.setup` 設定 UI 欄位。
- 使用 `TPDirect.card.getPrime` 在表單提交時取得 prime token。
- **即時渲染**：付款表單需要能夠即時渲染，當使用者選擇寶可夢、數量和地點後，付款金額應立即計算並顯示。
- **模擬後端**：由於我們沒有真實的後端，我們將使用 `console.log` 記錄交易詳情（Prime、金額、訂單資訊）並顯示成功提示。

## 5. UI/UX 草稿

- **標題**：「寶可夢代購服務」
- **步驟 1：訂單詳情**
  - 選擇寶可夢（下拉選單）
  - 選擇中心（下拉選單）
  - 數量（數字輸入）-> _數量 >= 10 時觸發「tomz12321」訊息_
- **步驟 2：付款**
  - 持卡人資訊（姓名、電子郵件、電話）
  - 信用卡欄位（TapPay Frames）
- **頁尾**：提交按鈕。
